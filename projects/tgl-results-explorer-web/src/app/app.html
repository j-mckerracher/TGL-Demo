<div class="app-shell">
  <!-- Status/Error Banner (top) -->
  <app-status-banner></app-status-banner>

  <!-- Offline/Update Banners -->
  <app-offline-banner></app-offline-banner>

  <!-- Fallback Banner (if active) -->
  <fallback-banner></fallback-banner>

  <!-- Main content area -->
  <main class="app-main">
    <!-- Left Panel: Controls -->
    <aside class="controls-panel">
      <controls
        [fallbackActive]="isFallbackActive()">
      </controls>
    </aside>

    <!-- Center: Dual Canvases -->
    <section class="visualization-area">
      <div class="canvas-container mechanism">
        <h2>Mechanism Visualization</h2>
        <mechanism-canvas
          [reducedMotion]="false"
          [simulationState$]="engineState$">
        </mechanism-canvas>
      </div>
      <div class="canvas-container p2p">
        <h2>P2P Baseline Visualization</h2>
        <p2p-canvas
          [reducedMotion]="false"
          [simulationState$]="engineState$">
        </p2p-canvas>
      </div>
    </section>

    <!-- Right Panel: Stats & Takeaway -->
    <aside class="stats-panel">
      <!-- Stats Chart -->
      @if (statsSeriesVisible()) {
        <section class="stats-section">
          <h3>Statistics</h3>
          <micro-line-chart
            [series]="chartSeries()">
          </micro-line-chart>
        </section>
      }

      <!-- Takeaway -->
      @if (runSummaryMechanism() && runSummaryP2P()) {
        <section class="takeaway-section">
          <takeaway
            [summaryA]="runSummaryMechanism()!"
            [summaryB]="runSummaryP2P()!"
            [includeAbsolutes]="false">
          </takeaway>
        </section>
      }

      <!-- Empty State -->
      @if (!statsSeriesVisible()) {
        <div class="empty-state">
          <p>Click "Run" to start simulation and see results here.</p>
        </div>
      }
    </aside>
  </main>
</div>
