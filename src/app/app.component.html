<div class="container">
  <!-- Left Sidebar - Compact Info Panels -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <h1>P2P vs TGL Network</h1>
      <p>Interactive Propagation Demo</p>
    </div>

    <!-- Configuration Controls -->
    <section class="sidebar-section">
      <div class="section-title">Network Configuration</div>
      <div class="control-panel">
        <div class="control-group">
          <div class="slider-container">
            <div class="control-row">
              <label class="control-label">Network Size</label>
              <span class="slider-value">{{ nodeCount() }} nodes</span>
            </div>
            <input
              type="range"
              min="20"
              max="100"
              step="5"
              [value]="nodeCount()"
              (input)="onNodeCountChange($event)"
              [disabled]="isPlaying()"
            />
          </div>
        </div>

        <div class="control-group">
          <div class="slider-container">
            <div class="control-row">
              <label class="control-label">Animation Speed</label>
              <span class="slider-value">{{ animationSpeed() | number: '1.2-2' }}x</span>
            </div>
            <input
              type="range"
              min="0.25"
              max="3"
              step="0.25"
              [value]="animationSpeed()"
              (input)="onAnimationSpeedChange($event)"
              [disabled]="isPlaying()"
            />
          </div>
        </div>
        <div class="control-group">
          <div class="slider-container">
            <div class="control-row">
              <label class="control-label">P2P Node Degree</label>
              <span class="slider-value">{{ averageDegree() }}</span>
            </div>
            <input
              type="range"
              min="2"
              max="8"
              step="1"
              [value]="averageDegree()"
              (input)="onAverageDegreeChange($event)"
              [disabled]="isPlaying()"
            />
          </div>
        </div>
      </div>
    </section>

    <section class="sidebar-section">
      <div class="section-title">TGL Parameters</div>
      <div class="control-panel">
        <div class="control-group">
          <label class="control-label" for="pushBudget">Push Budget</label>
          <select
            id="pushBudget"
            class="dropdown"
            [value]="pushBudget()"
            (change)="onPushBudgetChange($event)"
            [disabled]="isPlaying()"
          >
            @for (option of pushBudgetOptions; track option) {
              <option [value]="option">{{ option }}</option>
            }
          </select>
        </div>

        <div class="control-group">
          <label class="control-label" for="gossipBudget">Gossip Budget</label>
          <select
            id="gossipBudget"
            class="dropdown"
            [value]="gossipBudget()"
            (change)="onGossipBudgetChange($event)"
            [disabled]="isPlaying()"
          >
            @for (option of gossipBudgetOptions; track option) {
              <option [value]="option">{{ option }}</option>
            }
          </select>
        </div>

        <div class="control-group">
          <label class="control-label" for="pullBudget">Pull Budget</label>
          <select
            id="pullBudget"
            class="dropdown"
            [value]="pullBudget()"
            (change)="onPullBudgetChange($event)"
            [disabled]="isPlaying()"
          >
            @for (option of pullBudgetOptions; track option) {
              <option [value]="option">{{ option }}</option>
            }
          </select>
        </div>
      </div>
    </section>

    <!-- Info Banner Content (Compact Vertical) -->
    <app-info-banner></app-info-banner>

    <!-- Legend -->
    <section class="sidebar-section">
      <div class="section-title">Legend</div>
      <div class="legend-items">
        @for (item of legendItems; track item.label) {
          <div class="legend-item">
            <div class="legend-dot" [style.background]="item.color"></div>
            <span>{{ item.label }}</span>
          </div>
        }
      </div>
    </section>
  </aside>

  <!-- Main Content Area -->
  <main class="main-content">
    <!-- Top Controls Bar -->
    <div class="controls-bar">
      <div class="interaction-tips">
        <span class="tip-icon">üí°</span>
        <span class="tip-text">Scroll to zoom ‚Ä¢ Drag to rotate ‚Ä¢ Right-click to pan</span>
      </div>
      <div class="controls-center">
        <div class="round-display">
          Round: <strong>{{ currentRound() }}</strong> / {{ maxRounds() }}
        </div>
        <div class="playback-controls">
          <button class="control-btn" type="button" disabled title="Previous Round">‚èÆ</button>
          <button class="control-btn primary" type="button" (click)="togglePlayback()" title="Play/Pause">
            {{ isPlaying() ? '‚è∏' : '‚ñ∂' }}
          </button>
          <button class="control-btn" type="button" disabled title="Next Round">‚è≠</button>
          <button class="control-btn" type="button" (click)="onReset()" title="Reset">üîÑ</button>
        </div>
      </div>
    </div>

    <!-- Visualization Area -->
    <div class="visualization">
      <div class="viz-panel">
        <div class="viz-header">
          <span>Peer-to-Peer Network</span>
          <span class="viz-badge">BASELINE</span>
        </div>
        <div class="canvas-area">
          <app-network-canvas networkType="p2p"></app-network-canvas>
        </div>
      </div>

      <div class="viz-panel">
        <div class="viz-header">
          <span>Tiered Gossip Learning (TGL)</span>
          <span class="viz-badge tgl">TGL</span>
        </div>
        <div class="canvas-area">
          <app-network-canvas networkType="tgl"></app-network-canvas>
          <div class="stage-indicator">{{ stageBadgeText() }}</div>
        </div>
      </div>
    </div>

    <!-- Bottom Stats Bar -->
    <div class="stats-bar">
      <!-- P2P Stats -->
      <div class="stat-group">
        <div class="stat-item">
          <span class="stat-label">P2P Round</span>
          <span class="stat-value baseline">{{ p2pRound() }}</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">P2P Messages</span>
          <span class="stat-value baseline">{{ p2pMessages() }}</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">P2P Coverage</span>
          <span class="stat-value baseline">{{ p2pCoverageLabel() }}</span>
        </div>
      </div>

      <div class="comparison-divider"></div>

      <!-- Comparison Metrics -->
      <div class="comparison-metrics">
        <div class="metric">
          <span class="metric-icon">üìâ</span>
          <div class="metric-content">
            <span class="metric-label">Msg Savings</span>
            <span class="metric-value" [class.positive]="messageReduction() && messageReduction()! < 0">{{ messageReductionLabel() }}</span>
          </div>
        </div>
        <div class="metric">
          <span class="metric-icon">‚ö°</span>
          <div class="metric-content">
            <span class="metric-label">Speed Gain</span>
            <span class="metric-value" [class.positive]="speedGain() && speedGain()! > 0">{{ speedGainLabel() }}</span>
          </div>
        </div>
      </div>

      <div class="comparison-divider"></div>

      <!-- TGL Stats -->
      <div class="stat-group">
        <div class="stat-item">
          <span class="stat-label">TGL Round</span>
          <span class="stat-value tgl">{{ tglRound() }}</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">TGL Messages</span>
          <span class="stat-value tgl">{{ tglMessages() }}</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">TGL Coverage</span>
          <span class="stat-value tgl">{{ tglCoverageLabel() }}</span>
        </div>
      </div>
    </div>
  </main>
</div>
